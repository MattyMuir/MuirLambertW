#include <cmath>

double Approx1(double t)
{
	static constexpr double P[] = {
		-1.0000000016838044,
		-1.4142135326472736,
		-0.6666669058638272,
		-0.07856625663547433,
		0.014810989370645705,
		-0.0013004512420077908,
		-0.0004859967952482168,
		0.0003094998707541618,
		-9.892459173450023e-05,
		2.10615430371768e-05,
		-2.9196042059984366e-06,
		2.2309906186826503e-07,
		-5.440504682401704e-09
	};

	double res = P[12];
	for (size_t i = 0; i < 12; i++)
		res = res * t + P[11 - i];
	return res;
}

double Approx2(double t)
{
	static constexpr double P[] = {
		-0.9999834495082601,
		-1.4143185378689334,
		-0.6663602372212263,
		-0.07911195988460597,
		0.015470377072361244,
		-0.0018704507014697105,
		-0.000124969010629908,
		0.00014125767136782079,
		-4.210623635234014e-05,
		7.710849270629769e-06,
		-9.16924041500622e-07,
		6.549436149264605e-08,
		-2.1461259912811643e-09
	};

	double res = P[12];
	for (size_t i = 0; i < 12; i++)
		res = res * t + P[11 - i];
	return res;
}

double Approx3(double t)
{
	static constexpr double P[] = {
		-0.9995255479008107,
		-1.4161090281476763,
		-0.6630919319115665,
		-0.0827982103938873,
		0.01833302864705118,
		-0.003482938168570471,
		0.0005501965269057965,
		-7.02513306544614e-05,
		7.023271046760143e-06,
		-5.270892425794854e-07,
		2.7843392984152496e-08,
		-9.211720984068308e-10,
		1.4337178490395778e-11
	};

	double res = P[12];
	for (size_t i = 0; i < 12; i++)
		res = res * t + P[11 - i];
	return res;
}

double Approx4(double t)
{
	static constexpr double P[] = {
		-1.0142327684991408,
		-1.3871246560560697,
		-0.6895474078101955,
		-0.067991471769912,
		0.012666766219903019,
		-0.0019193626803821334,
		0.0002309063450026086,
		-2.1607190527136516e-05,
		1.534301232152275e-06,
		-7.974003233151024e-08,
		2.8577716975708306e-09,
		-6.308433049939651e-11,
		6.46254629621823e-13
	};

	double res = P[12];
	for (size_t i = 0; i < 12; i++)
		res = res * t + P[11 - i];
	return res;
}

double Approx5(double t)
{
	static constexpr double P[] = {
		-1.111184869621565,
		-1.2603961050447419,
		-0.7665023245375462,
		-0.03927276171290612,
		0.00532989818598617,
		-0.0005677902591025669,
		4.68943058560966e-05,
		-2.9645628993749833e-06,
		1.4065724440798284e-07,
		-4.847008509190621e-09,
		1.1455201704610291e-10,
		-1.661033966595275e-12,
		1.1146014518820042e-14
	};

	double res = P[12];
	for (size_t i = 0; i < 12; i++)
		res = res * t + P[11 - i];
	return res;
}

double Approx6(double t)
{
	static constexpr double P[] = {
		-1.3730180264253566,
		-1.0346377548032974,
		-0.856921917681805,
		-0.017025708277968926,
		0.0015853744044590627,
		-0.0001137566754403891,
		6.254177764842352e-06,
		-2.6111417017256954e-07,
		8.136183985085343e-09,
		-1.8337027428712693e-10,
		2.825410884928e-12,
		-2.6643668225627418e-14,
		1.160340090206658e-16
	};

	double res = P[12];
	for (size_t i = 0; i < 12; i++)
		res = res * t + P[11 - i];
	return res;
}

double Approx7(double t)
{
	static constexpr double P[] = {
		-2.103689719622501,
		-0.6556757609698591,
		-0.9489494891459312,
		-0.0031692190364335055,
		0.00014393034608299488,
		-4.676070766320222e-06,
		1.0584868982981378e-07,
		-1.5872888632202587e-09,
		1.4189019931769703e-11,
		-5.729734500162816e-14
	};

	double res = P[9];
	for (size_t i = 0; i < 9; i++)
		res = res * t + P[8 - i];
	return res;
}

double MuirWm1v2(double x)
{
	double t = sqrt(-1 - log(-x));

	if (t < 9)
	{
		if (t < 3)
		{
			if (t < 1.5) return Approx1(t);
			return Approx2(t);
		}

		if (t < 5.5) return Approx3(t);
		return Approx4(t);
	}
	if (t < 21.5)
	{
		if (t < 13.5) return Approx5(t);
		return Approx6(t);
	}

	return Approx7(t);
}