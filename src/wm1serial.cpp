#include <cmath>

static inline double AddEm(double x)
{
    static constexpr double emHigh = 0.36787944117144232160;
    static constexpr double emLow = -1.2428753672788363168e-17;

    return (x + emHigh) + emLow;
}

// [EM, -0.319479441171]
static inline double Approx1(double x)
{
    static constexpr double P[] = {
        1.5197052e-15,31.3824851452526241285,-111.67278816061234825522,132.56844458196190460952,-58.38140342237370500698,6.921494047532364758481
    };
    static constexpr double Q[] = {
        -13.459381188957388890888,58.355270690365974019853,-91.03160880750900351404,60.906593587527756567484,-15.896569491523573891795,1.
    };

    double t = sqrt(AddEm(x));

    double numer = P[5];
    for (size_t i = 0; i < 5; i++)
        numer = numer * t + P[4 - i];

    double denom = Q[5];
    for (size_t i = 0; i < 5; i++)
        denom = denom * t + Q[4 - i];

    return numer / denom - 1;
}

// [-0.319479441171, -0.183939720586]
static inline double Approx2(double x)
{
    static constexpr double P[] = {
        11.831659475957969317482,4.332578364581879758628,-2.628762536561297055886,-16.623512533549987404582,-22.93716813076782699036,-15.483503544726786699587,-6.791376212503861535896,-0.11521581840651910147013
    };
    static constexpr double Q[] = {
        10.258782195955256667732,16.335989870177192918951,23.682626606622170758043,21.619317230274269653267,13.337350406408996118098,5.9808686820132154967171,1.
    };

    double t = sqrt(-1.0 - 1.0 / (x * 2.718281828459045));

    double numer = P[7];
    for (size_t i = 0; i < 7; i++)
        numer = numer * t + P[6 - i];

    double denom = Q[6];
    for (size_t i = 0; i < 6; i++)
        denom = denom * t + Q[5 - i];

    return numer / denom - 2.1533203125;
}

// [-0.183939720586, -0.0309402389547]
static inline double Approx3(double x)
{
    static constexpr double P[] = {
        4865.5859031465212578,5405.066014725616375973,7395.512758790447633633,2668.501900136744456412,571.0453006978143973781,-1887.008518977112317301,-407.274969720937636452,-11.043062114472768759963
    };
    static constexpr double Q[] = {
        1681.8979891794263331259,2693.1761949916779791744,4248.7734908483022064286,3500.9651691049538052044,2341.589854151086162664,781.16540396562846025281,70.084822055620556489691,1.
    };

    double t = sqrt(-1.0 - 1.0 / (x * 2.718281828459045));

    double numer = P[7];
    for (size_t i = 0; i < 7; i++)
        numer = numer * t + P[6 - i];

    double denom = Q[7];
    for (size_t i = 0; i < 7; i++)
        denom = denom * t + Q[6 - i];

    return numer / denom - 3.892578125;
}

// [-0.0309402389547, -0.00253709959429]
static inline double Approx4(double x)
{
    static constexpr double P[] = {
        5.6539628427736770383966,5.9923867543111844533612,7.8950738952108704054947,2.0262810660055065247671,-0.17104827316796007861762,-0.048893711600991430788866,-0.0017678144949259999441899,-0.000010491279648402875028412
    };
    static constexpr double Q[] = {
        1.,1.389530755200497503219014,1.741407512762538699632285,1.096208480221021457802083,0.2220136192284824029559908,0.01459238617761729303701762,0.0002768967005269749321425197,9.244342315920872624236817e-7
    };

    double t = sqrt(-1.0 - 1.0 / (x * 2.718281828459045));

    double numer = P[7];
    for (size_t i = 0; i < 7; i++)
        numer = numer * t + P[6 - i];

    double denom = Q[7];
    for (size_t i = 0; i < 7; i++)
        denom = denom * t + Q[6 - i];

    return numer / denom - 6.5849609375;
}

// [-0.00253709959429, -0.000181579191101]
static inline double Approx5(double x)
{
    static constexpr double P[] = {
        9.74793835650159845421739,0.83610438726604859664693,-1.033257455749206125385636,-0.088104087013685358161469,0.00150038445052399956845282,0.000143863990662940002177096,1.47440910750864470751182e-6,2.44671226230618801574956e-9
    };
    static constexpr double Q[] = {
        1.,0.5269220618659215798738052,-0.1262211838914956362505402,-0.03995317543039112349305979,-0.002436375484488567869548114,-0.00004518559566998315681299341,-2.385214484207806768053433e-7,-2.203406001363072284256372e-10
    };

    double t = sqrt(-1.0 - 1.0 / (x * 2.718281828459045));

    double numer = P[7];
    for (size_t i = 0; i < 7; i++)
        numer = numer * t + P[6 - i];

    double denom = Q[7];
    for (size_t i = 0; i < 7; i++)
        denom = denom * t + Q[6 - i];

    return numer / denom - 9.5380859375;
}

// [-0.000181579191101, -0.0000101902839581]
static inline double Approx6(double x)
{
    static constexpr double P[] = {
        11.94117171245562456217414,3.52254357847774258126773,0.186711435201353380096369,0.00176611942845644311590178,-0.0000199753905184834247876275,-2.33620224079670971728112e-7,-4.96440749263670512265746e-10,-1.840129380001626387077882e-13
    };
    static constexpr double Q[] = {
        1.,0.5434614403182891608861701,0.05409663526535323110023416,0.00164420841615341091254926,0.00001773521887116338295890627,6.778797110103621694318938e-8,7.86796410849238453758014e-11,1.651764685534260257857105e-14
    };

    double t = sqrt(-1.0 - 1.0 / (x * 2.718281828459045));

    double numer = P[7];
    for (size_t i = 0; i < 7; i++)
        numer = numer * t + P[6 - i];

    double denom = Q[7];
    for (size_t i = 0; i < 7; i++)
        denom = denom * t + Q[6 - i];

    return numer / denom - 12.578125;
}

// [-0.0000101902839581, -5.5384679487e-7]
static inline double Approx7(double x)
{
    static constexpr double P[] = {
        11.73619715918550624392105,0.876989679312798219458357,0.0113418601319052847997061,0.0000262239113900409595914566,-6.6496954473593113396507e-8,-1.87885421802071953340156e-10,-9.47210433786667654445757e-14,-8.29681897588633102630585e-18
    };
    static constexpr double Q[] = {
        1.,0.1366420450069258886255458,0.003296906431827253581808808,0.00002396673123423484445666612,6.141817313725560958156361e-8,5.555084437722800832182986e-11,1.521597986236396883126093e-14,7.521725804095380678757044e-19
    };

    double t = sqrt(-1.0 - 1.0 / (x * 2.718281828459045));

    double numer = P[7];
    for (size_t i = 0; i < 7; i++)
        numer = numer * t + P[6 - i];

    double denom = Q[7];
    for (size_t i = 0; i < 7; i++)
        denom = denom * t + Q[6 - i];

    return numer / denom - 15.69921875;
}

// [-5.5384679487e-7, -2.8072968858e-8]
static inline double Approx8(double x)
{
    static constexpr double P[] = {
        11.40957569636317471413157,0.195249209436542997153761,0.000578719761709083717350448,3.064443918529065938638e-7,-1.78103022373627119536536e-10,-1.15071138450497655901825e-13,-1.32584121184733268383224e-17,-2.65212403124978063909621e-22
    };
    static constexpr double Q[] = {
        1.,0.03094909493567877114192129,0.0001705048613743532088025804,2.833653243455936757341206e-7,1.660018333932342761383351e-10,3.430522468765670107910011e-14,2.145359202275535646333541e-18,2.4188525353860264124646e-23
    };

    double t = sqrt(-1.0 - 1.0 / (x * 2.718281828459045));

    double numer = P[7];
    for (size_t i = 0; i < 7; i++)
        numer = numer * t + P[6 - i];

    double denom = Q[7];
    for (size_t i = 0; i < 7; i++)
        denom = denom * t + Q[6 - i];

    return numer / denom - 18.8291015625;
}

// [-2.8072968858e-8, -1.3677849487e-9]
static inline double Approx9(double x)
{
    static constexpr double P[] = {
        11.2150937046489948657079,0.0427280912660675863343777,0.0000282236241187769272060463,3.3301365429107026596379e-9,-4.3128421604648009425744e-13,-6.20449732526606220399285e-17,-1.59117108856248706426289e-21,-7.08139757235869018981781e-27
    };
    static constexpr double Q[] = {
        1.,0.006851220392802084493862276,8.393783960135605608813008e-6,3.104736970239080416444799e-9,4.048188235757307854765904e-13,1.861510880373067404682169e-17,2.589306040999539991048014e-22,6.489430277862294766767134e-28
    };

    double t = sqrt(-1.0 - 1.0 / (x * 2.718281828459045));

    double numer = P[7];
    for (size_t i = 0; i < 7; i++)
        numer = numer * t + P[6 - i];

    double denom = Q[7];
    for (size_t i = 0; i < 7; i++)
        denom = denom * t + Q[6 - i];

    return numer / denom - 21.9873046875;
}

// [-1.3677849487e-9, -6.4537422237e-11]
static inline double Approx10(double x)
{
    static constexpr double P[] = {
        11.091735499901686729079,0.00925233241484740729076757,1.33837942560481789952015e-6,3.4566886691671586684904e-11,-9.8071275399046959634802e-16,-3.08602947962614278806347e-20,-1.7308234755867891092888e-25,-1.68400071730471319438566e-31
    };
    static constexpr double Q[] = {
        1.,0.00149548233434459864528934,4.007596927261031708173975e-7,3.24319739640206431293349e-11,9.250551394780546527212607e-16,9.302538049875713222729503e-21,2.828659413774769783950379e-26,1.548958645901972101953013e-32
    };

    double t = sqrt(-1.0 - 1.0 / (x * 2.718281828459045));

    double numer = P[7];
    for (size_t i = 0; i < 7; i++)
        numer = numer * t + P[6 - i];

    double denom = Q[7];
    for (size_t i = 0; i < 7; i++)
        denom = denom * t + Q[6 - i];

    return numer / denom - 25.16015625;
}

// [-6.4537422237e-11, -3.090774553e-12]
static inline double Approx11(double x)
{
    static constexpr double P[] = {
        11.00316083476925166327978,0.00199828221287339674190649,6.2964501338343749390175e-8,3.5428198578211043793093e-13,-2.1922795653499248481599e-18,-1.50364158115734848336491e-23,-1.83893591474912721121529e-29,-3.90253540521904201895708e-36
    };
    static constexpr double Q[] = {
        1.,0.0003250293068868491172301666,1.895992245402533408132788e-8,3.341840425035655795729803e-13,2.076798923153931801486052e-18,4.551558747764747163998111e-24,3.016914263991044998372143e-30,3.601569595036311604551278e-37
    };

    double t = sqrt(-1.0 - 1.0 / (x * 2.718281828459045));

    double numer = P[7];
    for (size_t i = 0; i < 7; i++)
        numer = numer * t + P[6 - i];

    double denom = Q[7];
    for (size_t i = 0; i < 7; i++)
        denom = denom * t + Q[6 - i];

    return numer / denom - 28.3251953125;
}

// [-3.090774553e-12, -1.4370290671e-13]
static inline double Approx12(double x)
{
    static constexpr double P[] = {
        10.94291215069882076542618,0.000432072144600063667938794,2.9592513664859959753176e-9,3.6187332060224797658868e-15,-4.8596030567618708759683e-21,-7.2381949335676585303501e-27,-1.92118652350629822579293e-33,-8.84470004040319614847517e-41
    };
    static constexpr double Q[] = {
        1.,0.00007057764027859856087605361,8.943486579950542515416968e-10,3.423801852828053747417878e-15,4.619956113077978750688394e-21,2.197699753602681029504978e-27,3.160566218320744261860132e-34,8.182498321539207849536703e-42
    };

    double t = sqrt(-1.0 - 1.0 / (x * 2.718281828459045));

    double numer = P[7];
    for (size_t i = 0; i < 7; i++)
        numer = numer * t + P[6 - i];

    double denom = Q[7];
    for (size_t i = 0; i < 7; i++)
        denom = denom * t + Q[6 - i];

    return numer / denom - 31.4853515625;
}

// [-1.4370290671e-13, -6.0466706307e-15]
static inline double Approx13(double x)
{
    static constexpr double P[] = {
        10.90333518993820009937051,0.000090912503754123542068529,1.31312097116621573421842e-10,3.3817864885615092560904e-17,-9.548915455596204440277e-24,-2.98689143801056249466311e-30,-1.66249380813197215886014e-37,-1.60268757499899911243099e-45
    };
    static constexpr double Q[] = {
        1.,0.00001488861768319336469844807,3.976774879552406140924286e-11,3.205124728339609002162128e-17,9.093218636640336634548299e-24,9.082524924171426055040889e-31,2.738858649220987585388573e-38,1.484736743316051480074959e-46
    };

    double t = sqrt(-1.0 - 1.0 / (x * 2.718281828459045));

    double numer = P[7];
    for (size_t i = 0; i < 7; i++)
        numer = numer * t + P[6 - i];

    double denom = Q[7];
    for (size_t i = 0; i < 7; i++)
        denom = denom * t + Q[6 - i];

    return numer / denom - 34.701171875;
}

// [-6.0466706307e-15, -2.5476415594e-16]
static inline double Approx14(double x)
{
    static constexpr double P[] = {
        10.86290201985498434835432,0.0000185793784684485466311807,5.5048647009689475459459e-12,2.9072046174962059340172e-19,-1.6865899558843015510895e-26,-1.08189809730354240016069e-33,-1.23542228074185174236264e-41,-2.44359675008009175532185e-50
    };
    static constexpr double Q[] = {
        1.,3.052498779670840184648292e-6,1.672234126096813882256012e-12,2.764575850136821977013684e-19,1.608959333664611605909249e-26,3.296802285972433635098163e-34,2.03948467386660890457538e-42,2.268031256176422488515006e-51
    };

    double t = sqrt(-1.0 - 1.0 / (x * 2.718281828459045));

    double numer = P[7];
    for (size_t i = 0; i < 7; i++)
        numer = numer * t + P[6 - i];

    double denom = Q[7];
    for (size_t i = 0; i < 7; i++)
        denom = denom * t + Q[6 - i];

    return numer / denom - 37.9580078125;
}

// [-2.5476415594e-16, -2.6691902155e-109]
static inline double Approx15(double x)
{
    static constexpr double P[] = {
        0.2289233735625319561329986,1.27489588491681175159486,-0.272209865610112987477448,0.0139212210839915658920449,-0.000238166750606321571157811,1.467911722678147921337e-6,-3.0362210600979192627074e-9,1.5577214233335360698974e-12,-2.67464703947969328394e-17
    };
    static constexpr double Q[] = {
        1.,-0.7592516273253019888609467,0.09507228628677154851415942,-0.003607526784702794900219909,0.00004954505848753638463898498,-2.528631350186927701141208e-7,4.340563135317533108354326e-10,-1.768465547880003549487153e-13
    };

    double t = log(-x);

    double numer = P[8];
    for (size_t i = 0; i < 8; i++)
        numer = numer * t + P[7 - i];

    double denom = Q[7];
    for (size_t i = 0; i < 7; i++)
        denom = denom * t + Q[6 - i];

    return numer / denom + t;
}

// [-2.6691902155e-109, 0]
static inline double Approx16(double x)
{
    static constexpr double P[] = {
        -1.661309046837212002926177,0.25473943353104979696865,-0.0040756611116238984259032,0.000015680788204719714133343,-1.6389125764261021128549e-8,3.726635243274692430052e-12,-2.41506494096324469778e-17
    };
    static constexpr double Q[] = {
        1.,-0.06775640628239357321589817,0.0007892257946267817333258018,-2.447235518483820625856186e-6,2.115764840033182067585924e-9,-3.859323438727230804316222e-13
    };

    double t = log(-x);

    double numer = P[6];
    for (size_t i = 0; i < 6; i++)
        numer = numer * t + P[5 - i];

    double denom = Q[5];
    for (size_t i = 0; i < 5; i++)
        denom = denom * t + Q[4 - i];

    return numer / denom + t;
}

double MuirWm1(double x)
{
    if (x < -2.8072968858e-8)
    {
        if (x < -0.00253709959429)
        {
            if (x < -0.183939720586)
            {
                if (x < -0.319479441171) return Approx1(x);
                return Approx2(x);
            }
            if (x < -0.0309402389547) return Approx3(x);
            return Approx4(x);
        }
        if (x < -0.0000101902839581)
        {
            if (x < -0.000181579191101) return Approx5(x);
            return Approx6(x);
        }
        if (x < -5.5384679487e-7) return Approx7(x);
        return Approx8(x);
    }
    if (x < -1.4370290671e-13)
    {
        if (x < -6.4537422237e-11)
        {
            if (x < -1.3677849487e-9) return Approx9(x);
            return Approx10(x);
        }
        if (x < -3.090774553e-12) return Approx11(x);
        return Approx12(x);
    }
    if (x < -2.5476415594e-16)
    {
        if (x < -6.0466706307e-15) return Approx13(x);
        return Approx14(x);
    }
    if (x < -2.6691902155e-109) return Approx15(x);
    return Approx16(x);
}